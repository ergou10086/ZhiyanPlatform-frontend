"use strict";(self["webpackChunkzhiyan_front"]=self["webpackChunkzhiyan_front"]||[]).push([[82],{82:function(e,s,t){t.d(s,{taskAPI:function(){return c}});var a=t(505),o=t.n(a),r=t(303);const n=o().create({baseURL:"",timeout:r.Ay.api.timeout,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});n.interceptors.request.use(e=>{const s=localStorage.getItem("access_token");return s&&(e.headers.Authorization=`Bearer ${s}`),console.log("任务API请求:",e.method?.toUpperCase(),e.url),console.log("请求数据:",e.data),e},e=>(console.error("请求拦截器错误:",e),Promise.reject(e))),n.interceptors.response.use(e=>(console.log("任务API响应:",e.status,e.data),e.data),e=>{if(console.error("任务API错误:",e),e.response){const{status:s,data:t}=e.response;return console.error("服务器错误:",s,t),401===s&&(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user_info"),window.location.href="/login"),Promise.reject(t||e)}return e.request?(console.error("网络错误:",e.request),Promise.reject(new Error("网络连接失败，请检查后端服务"))):(console.error("其他错误:",e.message),Promise.reject(e))});const c={createTask(e){return console.log("[taskAPI.createTask] 创建任务, 数据:",e),n.post("/zhiyan/api/projects/tasks",e)},async createTasksBatch(e,s){console.log("[taskAPI.createTasksBatch] 批量创建任务, 项目ID:",e,"任务数量:",s.length);const t=[],a=[];for(let r=0;r<s.length;r++){const n=s[r];try{const a=await this.createTask({projectId:e,title:n.title,description:n.description,assigneeIds:n.assignee_id||[],priority:n.priority_value||"MEDIUM",dueDate:n.dueDate||n.due_date||null,worktime:n.worktime||null});console.log(`任务 ${r+1}/${s.length} 创建成功:`,a),t.push(a)}catch(o){console.error(`任务 ${r+1}/${s.length} 创建失败:`,o),a.push({task:n,error:o})}}return{success:t.length,failed:a.length,total:s.length,results:t,errors:a}},updateTask(e,s){return console.log("[taskAPI.updateTask] 更新任务, ID:",e,"数据:",s),n.put(`/zhiyan/api/projects/tasks/${e}`,s)},deleteTask(e){return console.log("[taskAPI.deleteTask] 删除任务, ID:",e),n.delete(`/zhiyan/api/projects/tasks/${e}`)},getTaskDetail(e){return console.log("[taskAPI.getTaskDetail] 获取任务详情, ID:",e),n.get(`/zhiyan/api/projects/tasks/${e}`)},getTaskBoard(e){return console.log("[taskAPI.getTaskBoard] 获取任务看板, 项目ID:",e),n.get(`/zhiyan/api/projects/tasks/projects/${e}/board`)},getProjectTasks(e,s=0,t=20){return console.log("[taskAPI.getProjectTasks] 获取项目任务列表, 项目ID:",e),n.get(`/zhiyan/api/projects/tasks/projects/${e}`,{params:{page:s,size:t}})},updateTaskStatus(e,s){return console.log("[taskAPI.updateTaskStatus] 更新任务状态, ID:",e,"状态:",s),n.patch(`/zhiyan/api/projects/tasks/${e}/status`,{status:s})},assignTask(e,s){return console.log("[taskAPI.assignTask] 分配任务, ID:",e,"执行者:",s),n.put(`/zhiyan/api/projects/tasks/${e}/assign`,s)},claimTask(e){return console.log("[taskAPI.claimTask] 接取任务, ID:",e),n.post(`/zhiyan/api/projects/tasks/${e}/claim`)},getMyAssignedTasks(e=0,s=20){return console.log("[taskAPI.getMyAssignedTasks] 获取我的任务"),n.get("/zhiyan/api/projects/tasks/my-assigned",{params:{page:e,size:s}})},getMyCreatedTasks(e=0,s=20){return console.log("[taskAPI.getMyCreatedTasks] 获取我创建的任务"),n.get("/zhiyan/api/projects/tasks/my-created",{params:{page:e,size:s}})},searchTasks(e,s,t=0,a=20){return console.log("[taskAPI.searchTasks] 搜索任务, 关键词:",s),n.get(`/zhiyan/api/projects/tasks/projects/${e}/search`,{params:{keyword:s,page:t,size:a}})},getUpcomingTasks(e,s=7,t=0,a=20){return console.log("[taskAPI.getUpcomingTasks] 获取即将到期的任务"),n.get(`/zhiyan/api/projects/tasks/projects/${e}/upcoming`,{params:{days:s,page:t,size:a}})},getOverdueTasks(e,s=0,t=20){return console.log("[taskAPI.getOverdueTasks] 获取已逾期的任务"),n.get(`/zhiyan/api/projects/tasks/projects/${e}/overdue`,{params:{page:s,size:t}})},countProjectTasks(e){return console.log("[taskAPI.countProjectTasks] 统计项目任务"),n.get(`/zhiyan/api/projects/tasks/projects/${e}/count`)}}}}]);
//# sourceMappingURL=82.90628a8d.js.map